2025-05-05 23:05:46,101 - test_step_2_calculate_fts - INFO - Starting Spark session for testing...
2025-05-05 23:05:57,214 - test_step_2_calculate_fts - INFO - Starting test_feature_calculation_logic...
2025-05-05 23:05:57,428 - test_step_2_calculate_fts - INFO - Loading sample data from: s3a://transaction-data-raw/daily/
2025-05-05 23:06:20,260 - test_step_2_calculate_fts - INFO - Loaded 214 rows for testing.
2025-05-05 23:06:20,260 - test_step_2_calculate_fts - INFO - Checking if bucket exists: temp-data
2025-05-05 23:06:20,295 - test_step_2_calculate_fts - INFO - Saving sample data to: s3a://temp-data/daily/
2025-05-05 23:06:36,760 - test_step_2_calculate_fts - INFO - Sample data saved successfully.
2025-05-05 23:06:36,761 - test_step_2_calculate_fts - INFO - Reading sample data back from: s3a://temp-data/daily/
2025-05-05 23:06:38,126 - test_step_2_calculate_fts - INFO - Successfully read 214 rows from temporary path.
2025-05-05 23:06:38,126 - test_step_2_calculate_fts - INFO - Calculating expected results...
2025-05-05 23:06:41,038 - test_step_2_calculate_fts - INFO - Calculated expected results: 3 rows.
2025-05-05 23:06:41,043 - test_step_2_calculate_fts - INFO - Reading output from: s3a://transaction-data/features/
2025-05-05 23:06:47,861 - test_step_2_calculate_fts - INFO - Actual results count: 3
2025-05-05 23:06:47,862 - test_step_2_calculate_fts - INFO - test_feature_calculation_logic completed successfully.
2025-05-05 23:06:47,866 - test_step_2_calculate_fts - INFO - Starting test_date_validation...
2025-05-05 23:06:47,867 - test_step_2_calculate_fts - INFO - Testing invalid date validation...
2025-05-05 23:06:47,870 - test_step_2_calculate_fts - ERROR - Invalid date format: invalid-date. Please use YYYY-MM-DD format.
2025-05-05 23:06:47,871 - test_step_2_calculate_fts - INFO - SystemExit with code 1 verified.
2025-05-05 23:06:47,872 - test_step_2_calculate_fts - INFO - Invalid date error message assertion passed.
2025-05-05 23:06:47,872 - test_step_2_calculate_fts - INFO - test_date_validation completed successfully.
2025-05-05 23:12:56,437 - test_step_2_calculate_fts - INFO - Starting test_minio_connection...
2025-05-05 23:12:56,444 - test_step_2_calculate_fts - INFO - Successfully connected to MinIO. Buckets found: [Bucket('temp-data'), Bucket('transaction-data'), Bucket('transaction-data-raw')]
2025-05-05 23:12:56,444 - test_step_2_calculate_fts - INFO - test_minio_connection completed successfully.
2025-05-05 23:12:56,446 - test_step_2_calculate_fts - INFO - Starting Spark session for testing...
2025-05-05 23:13:05,381 - test_step_2_calculate_fts - INFO - Starting test_feature_calculation_logic...
2025-05-05 23:13:05,381 - test_step_2_calculate_fts - INFO - Loading sample data from: s3a://transaction-data-raw/daily/
2025-05-05 23:13:25,570 - test_step_2_calculate_fts - INFO - Loaded 214 rows for testing.
2025-05-05 23:13:25,570 - test_step_2_calculate_fts - INFO - Checking if bucket exists: temp-data
2025-05-05 23:13:25,580 - test_step_2_calculate_fts - INFO - Saving sample data to: s3a://temp-data/daily/
2025-05-05 23:13:37,686 - test_step_2_calculate_fts - INFO - Sample data saved successfully.
2025-05-05 23:13:37,687 - test_step_2_calculate_fts - INFO - Reading sample data back from: s3a://temp-data/daily/
2025-05-05 23:13:38,879 - test_step_2_calculate_fts - INFO - Successfully read 214 rows from temporary path.
2025-05-05 23:13:38,879 - test_step_2_calculate_fts - INFO - Calculating expected results...
2025-05-05 23:13:41,357 - test_step_2_calculate_fts - INFO - Calculated expected results: 3 rows.
2025-05-05 23:13:41,363 - test_step_2_calculate_fts - INFO - Reading output from: s3a://transaction-data/features/
2025-05-05 23:13:45,247 - test_step_2_calculate_fts - INFO - Actual results count: 3
2025-05-05 23:13:45,249 - test_step_2_calculate_fts - INFO - test_feature_calculation_logic completed successfully.
2025-05-05 23:13:45,252 - test_step_2_calculate_fts - INFO - Starting test_date_validation...
2025-05-05 23:13:45,254 - test_step_2_calculate_fts - INFO - Testing invalid date validation...
2025-05-05 23:13:45,255 - test_step_2_calculate_fts - ERROR - Invalid date format: invalid-date. Please use YYYY-MM-DD format.
2025-05-05 23:13:45,256 - test_step_2_calculate_fts - INFO - SystemExit with code 1 verified.
2025-05-05 23:13:45,256 - test_step_2_calculate_fts - INFO - Invalid date error message assertion passed.
2025-05-05 23:13:45,256 - test_step_2_calculate_fts - INFO - test_date_validation completed successfully.
